p8105_hw2_js6177
================
Jiayi Shi
2022-10-01

``` r
library(tidyverse)
```

## Problem 1

### Read and clean data

The code below read and do some cleaning after viewing the original
data.

``` r
transit_data = read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>% 
  select(2:5, starts_with("route"), entry, vending, entrance_type, ada_compliance = ada) %>% 
  mutate(
    entry = recode(entry,"YES"=TRUE,"NO"=FALSE),
  )
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

- Cleaning steps

After loading the data, I clean the variables’ names using
`janitor::clean_names()` and select the required variables for a new
dataset `transit_data`, including `line`, `station_name`,
`station_latitude`, `station_longitude`, `route1-11`, `entry`,
`vending`, `entrance_type`, and `ada_compliance`. Next, I convert the
`entry` from character (`YES` & `NO`) to a logical variable (`TRUE` &
`FALSE`). The dimension of the resulting dataset is 1868 x 19.

These data are still not tidy enough from my perspective. First, the
route containing many missing values can be further cleaned.
Furthermore, the vending variable can be converted to logic variable and
there are repeated rows in the dataset.

``` r
dist_station = distinct(transit_data, line, station_name, .keep_all = T)
```

- There are 465 distinct stations.  
- 84 stations are ADA compliant.
- 3.69% station entrances / exits without vending allow entrance.

### Reformat data

I convert the `route8-11` from numeric to character variables as
`route1-7` so as to use `pivot_longer` to make route number and route
name distinct variables. In this step, I also drop the NA value.
Finally, I relocate columns in the dataset `transit_data_ref` as the
problem specified.

``` r
transit_data_ref = 
  mutate_at(transit_data, c("route8","route9","route10","route11"),as.character) %>% 
  pivot_longer(
    starts_with("route"),
    names_to = "route_number",
    names_prefix = "route",
    values_to = "route_name",
    values_drop_na = T
  ) %>%
  select(1:4, route_number, route_name, everything()) %>% 
  mutate(route_number = as.numeric(route_number))

dist_station_ref = distinct(transit_data_ref, line, station_name, .keep_all = T)
```

- There are 60 stations serving the A train, and 17 of them are ADA
  compliant.
